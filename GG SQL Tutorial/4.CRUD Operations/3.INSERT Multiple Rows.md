No **SQL**, a instruÃ§Ã£o **INSERT** Ã© usada para adicionar **novos registros** em uma tabela de banco de dados. Quando precisamos **inserir vÃ¡rias linhas** em uma Ãºnica consulta, o comando **INSERT** torna-se mais eficiente.

Neste artigo, aprenderemos diferentes mÃ©todos para inserir mÃºltiplas linhas, incluindo **uso de INSERT bÃ¡sico**, **INSERT INTO â€¦ SELECT para inserÃ§Ãµes em massa** e **transaÃ§Ãµes para grandes conjuntos de dados**. AlÃ©m disso, discutiremos **tÃ©cnicas avanÃ§adas** e **dicas de otimizaÃ§Ã£o** para inserir dados de forma eficiente.

### **Como Inserir MÃºltiplas Linhas no SQL?**

A inserÃ§Ã£o de dados em uma tabela Ã© uma operaÃ§Ã£o **DML (Data Manipulation Language)** no SQL. Quando queremos armazenar dados, precisamos **inserir esses registros** no banco de dados. Utilizamos a **instruÃ§Ã£o INSERT** para isso.

Podemos **inserir mÃºltiplas linhas** de vÃ¡rias maneiras:
1. **Usando INSERT bÃ¡sico com vÃ¡rias listas de valores**.
2. **Utilizando INSERT INTO â€¦ SELECT** para transferir dados entre tabelas.
3. **Executando transaÃ§Ãµes para inserÃ§Ãµes em lote**.

Antes de explorar essas tÃ©cnicas, **criamos uma tabela de exemplo**.

### **Criando uma Tabela**

Criamos uma tabela chamada **Employees** com **4 colunas**, que serÃ¡ usada nos exemplos abaixo:

```
CREATE TABLE Employees (
    EmployeeID INT PRIMARY KEY,
    EmployeeName VARCHAR(100),
    Age INT,
    Department VARCHAR(50)
);
```

## **1. InserÃ§Ã£o BÃ¡sica de MÃºltiplas Linhas**

A maneira mais simples de inserir **vÃ¡rios registros** Ã© utilizando **um Ãºnico comando INSERT INTO**, seguido por mÃºltiplos conjuntos de valores.

```
INSERT INTO Employees (EmployeeID, EmployeeName, Age, Department)
VALUES
    (1, 'John Doe', 30, 'Engenharia'),
    (2, 'Jane Smith', 28, 'Marketing'),
    (3, 'Sam Brown', 35, 'Vendas'),
    (4, 'Lucy Green', 25, 'Recursos Humanos');
```

##### **SaÃ­da**

|EmployeeID|EmployeeName|Age|Department|
|---|---|---|---|
|1|John Doe|30|Engenharia|
|2|Jane Smith|28|Marketing|
|3|Sam Brown|35|Vendas|
|4|Lucy Green|25|Recursos Humanos|

ğŸ“Œ **Esse mÃ©todo Ã© eficaz**, pois reduz a necessidade de **mÃºltiplas instruÃ§Ãµes INSERT**.

## **2. Usando INSERT INTO â€¦ SELECT para InserÃ§Ã£o em Massa**

O **INSERT INTO â€¦ SELECT** Ã© Ãºtil para inserir **vÃ¡rias linhas** em uma tabela **com base nos resultados de outra consulta** ou de uma tabela diferente. Esse mÃ©todo Ã© frequentemente usado para **transferÃªncia de dados** ou para **inserÃ§Ã£o de dados derivados**.

Criamos uma segunda tabela chamada **NewEmployees**:

```
CREATE TABLE NewEmployees (
    EmployeeID INT PRIMARY KEY,
    EmployeeName VARCHAR(100),
    Age INT,
    Department VARCHAR(50)
);
```

Agora, inserimos registros na tabela **NewEmployees**:

```
INSERT INTO NewEmployees (EmployeeID, EmployeeName, Age, Department)
VALUES
    (5, 'Alice Johnson', 29, 'RH'),
    (6, 'Bob Martin', 32, 'FinanÃ§as'),
    (7, 'Charlie Baker', 28, 'Marketing'),
    (8, 'David Lee', 40, 'Engenharia'),
    (9, 'Eva Davis', 22, 'Vendas');
```

Agora, copiamos **apenas funcionÃ¡rios com idade maior que 30** para a tabela **Employees**:

```
INSERT INTO Employees (EmployeeID, EmployeeName, Age, Department)
SELECT EmployeeID, EmployeeName, Age, Department
FROM NewEmployees
WHERE Age > 30;
```

##### **SaÃ­da**

|EmployeeID|EmployeeName|Age|Department|
|---|---|---|---|
|1|John Doe|30|Engenharia|
|2|Jane Smith|28|Marketing|
|3|Sam Brown|35|Vendas|
|4|Lucy Green|25|RH|
|6|Bob Martin|32|FinanÃ§as|
|8|David Lee|40|Engenharia|

ğŸ“Œ _Esse mÃ©todo Ã© excelente para transferir_ _**dados relevantes**_ _sem precisar digitÃ¡-los manualmente._

## **3. Inserindo Dados Usando TransaÃ§Ãµes**

Quando inserimos **grandes volumes de dados**, podemos usar **transaÃ§Ãµes** para garantir que todas as linhas sejam **inseridas corretamente**.

ğŸ“Œ _Uma transaÃ§Ã£o agrupa vÃ¡rias operaÃ§Ãµes SQL em uma Ãºnica unidade. Se uma operaÃ§Ã£o falhar, toda a transaÃ§Ã£o pode ser_ _**desfeita (ROLLBACK)**__._

```
BEGIN TRANSACTION;

    INSERT INTO Customers (CustomerID, CustomerName, ContactName, Country)
    VALUES (5, 'Sarah White', 'John White', 'CanadÃ¡');
    
    INSERT INTO Customers (CustomerID, CustomerName, ContactName, Country)
    VALUES (6, 'Mohamed Ibrahim', 'Ahmed Ibrahim', 'Emirados Ãrabes');
    
    -- Se ocorrer erro, a transaÃ§Ã£o serÃ¡ cancelada

COMMIT;
```

##### **SaÃ­da**

|EmployeeID|EmployeeName|Age|Department|
|---|---|---|---|
|1|John Doe|30|Engenharia|
|2|Jane Smith|28|Marketing|
|3|Sam Brown|35|Vendas|
|4|Lucy Green|25|RH|
|6|Bob Martin|32|FinanÃ§as|
|8|David Lee|40|Engenharia|

### **ConclusÃ£o**

ğŸ“Œ A inserÃ§Ã£o de **mÃºltiplas linhas no SQL** pode ser feita de diferentes maneiras, dependendo do **caso de uso**: 
âœ… **MÃ©todo bÃ¡sico** para inserir mÃºltiplos registros rapidamente. 
âœ… **INSERT INTO â€¦ SELECT** para copiar dados de uma tabela para outra. 
âœ… **Uso de transaÃ§Ãµes** para inserÃ§Ãµes de grandes volumes de dados **com seguranÃ§a**.

O SQL fornece ferramentas **poderosas** para inserir grandes volumes de dados **de forma eficiente**! ğŸš€

