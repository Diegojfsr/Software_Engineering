A instruÃ§Ã£o **FETCH** no **SQL** Ã© comumente usada para **recuperar um subconjunto de registros** de um conjunto de resultados, especialmente ao lidar com **grandes volumes de dados**, **cursors** ou **linhas que precisam ser recuperadas de forma incremental**.

ðŸ“Œ **Geralmente Ã© utilizada junto com cursores SQL** para recuperar **linhas de um conjunto de resultados de maneira controlada e gradual**.

Neste artigo, discutiremos **o comando FETCH no SQL**, incluindo **seu uso, sintaxe e exemplos prÃ¡ticos**, indo de **conceitos bÃ¡sicos** atÃ© **casos de uso avanÃ§ados**.

## **FETCH no SQL**

A instruÃ§Ã£o **SQL FETCH** Ã© usada para **recuperar um subconjunto de linhas** de um conjunto de resultados, geralmente apÃ³s aplicar um **ORDER BY** e um **OFFSET** para definir o ponto de inÃ­cio.

ðŸš€ **Ã‰ amplamente utilizada em paginaÃ§Ã£o**, onde queremos **recuperar um nÃºmero limitado de registros de cada vez**, como: 
âœ… **Os registros principais** (ex.: os 5 melhores alunos). 
âœ… **Intervalos especÃ­ficos** (ex.: exibir registros da posiÃ§Ã£o 10 a 20). 
âœ… **Busca sequencial de dados**.

## **Regras Importantes do FETCH**

âœ… O uso de **OFFSET** Ã© **obrigatÃ³rio** com FETCH. 
âœ… **ORDER BY** Ã© **necessÃ¡rio** para garantir uma sequÃªncia consistente de registros. 
âœ… **NÃ£o Ã© permitido combinar TOP com OFFSET e FETCH**. 
âœ… O **nÃºmero de linhas no FETCH NEXT** deve ser uma **expressÃ£o numÃ©rica vÃ¡lida** (constante, aritmÃ©tica ou parametrizada).

## **Sintaxe**

```
SELECT nome_da_coluna(s)
FROM nome_da_tabela
ORDER BY nome_da_coluna
OFFSET nÃºmero_de_linhas_a_ignorar ROWS
FETCH NEXT nÃºmero_de_linhas_a_retornar ROWS ONLY;
```

## **Exemplo de FETCH no SQL**

Vamos criar uma **tabela chamada "MarkList"** para armazenar **notas de alunos** e depois usar o **FETCH** para recuperar um subconjunto de registros.

### **Criando a tabela "MarkList"**

```
CREATE TABLE MarkList (
    id INT,
    name VARCHAR(20),
    mathematics INT, 
    physics INT,
    chemistry INT
);

INSERT INTO MarkList VALUES (501, 'Surya', 99, 97, 85);
INSERT INTO MarkList VALUES (502, 'Charan', 99, 93, 88);
INSERT INTO MarkList VALUES (503, 'Sravan', 91, 98, 94);
INSERT INTO MarkList VALUES (504, 'Ram', 92, 99, 82);
INSERT INTO MarkList VALUES (505, 'Aryan', 94, 99, 88);
INSERT INTO MarkList VALUES (506, 'Sathwik', 91, 88, 91);
INSERT INTO MarkList VALUES (507, 'Madhav', 90, 97, 89);
```

ðŸ“Œ **ApÃ³s a inserÃ§Ã£o, a tabela terÃ¡ os seguintes registros:**

|ID|Nome|MatemÃ¡tica|FÃ­sica|QuÃ­mica|
|---|---|---|---|---|
|501|Surya|99|97|85|
|502|Sravan|91|98|94|
|503|Charan|99|93|88|
|504|Ram|92|99|82|
|505|Aryan|94|99|88|
|506|Sathwik|91|88|91|
|507|Madhav|90|97|89|

## **Exemplo 1: Recuperar os 3 melhores alunos**

ðŸŽ¯ **Recuperar os IDs, nomes e total de notas dos 3 melhores alunos (ordenados pelo total de pontos em ordem decrescente).**

```
SELECT id, name, (mathematics + physics + chemistry) AS total
FROM MarkList
ORDER BY (mathematics + physics + chemistry) DESC
OFFSET 0 ROWS
FETCH NEXT 3 ROWS ONLY;
```

##### **SaÃ­da**

|ID|Nome|Total|
|---|---|---|
|503|Sravan|283|
|501|Surya|281|
|505|Aryan|281|

ðŸ“Œ **Usamos OFFSET 0 para comeÃ§ar do primeiro registro e FETCH NEXT 3 para trazer os 3 melhores alunos!**

## **ConsideraÃ§Ãµes de Desempenho**

ðŸ“Œ **Melhore o desempenho ao usar FETCH seguindo estas prÃ¡ticas:** 
âœ… **Certifique-se de que as colunas do ORDER BY estejam indexadas** para melhorar a velocidade da consulta. 
âœ… **Use FETCH para paginaÃ§Ã£o** em **APIs e aplicaÃ§Ãµes web** que precisam exibir dados em blocos (ex.: 10 registros por pÃ¡gina).

## **RestriÃ§Ãµes do SQL FETCH**

ðŸš¨ **O uso de ORDER BY Ã© obrigatÃ³rio** ao combinar **OFFSET e FETCH**. ðŸš¨ **NÃ£o Ã© permitido usar TOP junto com OFFSET e FETCH** na mesma consulta. ðŸš¨ **O nÃºmero de linhas em FETCH NEXT deve ser um nÃºmero inteiro vÃ¡lido**.

## **ConclusÃ£o**

ðŸ“Œ **O SQL FETCH Ã© uma ferramenta essencial para recuperar um intervalo especÃ­fico de registros de um conjunto de resultados**.

âœ… **Usado frequentemente em paginaÃ§Ã£o** e quando lidamos com **grandes volumes de dados**. 
âœ… **Combinado com OFFSET e ORDER BY**, permite **recuperar subconjuntos ordenados de dados**. 
âœ… **Facilita a implementaÃ§Ã£o de recursos como "Top N registros" ou "Resultados paginados"**.

ðŸš€ **Dominar o FETCH tornarÃ¡ suas consultas SQL mais precisas e eficientes!**

