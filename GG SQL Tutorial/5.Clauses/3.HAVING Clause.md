A clÃ¡usula **HAVING** no **SQL** Ã© usada para **filtrar resultados de consultas com funÃ§Ãµes agregadas**.

Diferente da clÃ¡usula **WHERE**, que filtra **linhas individuais antes da agrupaÃ§Ã£o**, a clÃ¡usula **HAVING** filtra **grupos de dados apÃ³s a agregaÃ§Ã£o**.

ğŸ“Œ Ela Ã© comumente usada com funÃ§Ãµes como **SUM(), AVG(), COUNT(), MAX() e MIN()**.

Neste artigo, aprenderemos **o conceito da clÃ¡usula HAVING**, sua **sintaxe**, e veremos **exemplos prÃ¡ticos**.

### **O que Ã© a clÃ¡usula SQL HAVING?**

A clÃ¡usula **HAVING** Ã© usada para **filtrar os resultados da instruÃ§Ã£o GROUP BY** com base em **condiÃ§Ãµes especificadas**.
ğŸ“Œ Permite a filtragem de dados agrupados usando **condiÃ§Ãµes lÃ³gicas (AND, OR)**.
ğŸ“Œ Foi introduzida porque a clÃ¡usula **WHERE nÃ£o pode ser usada com funÃ§Ãµes agregadas**.
ğŸ“Œ **Assim como a clÃ¡usula WHERE**, ela ajuda a **aplicar condiÃ§Ãµes**, mas **especificamente em dados agrupados**.
ğŸš€ **Quando precisamos filtrar resultados agregados, a clÃ¡usula HAVING Ã© a escolha apropriada!**

### **Principais caracterÃ­sticas da clÃ¡usula HAVING**

âœ… **Filtra dados agrupados** com base em **funÃ§Ãµes agregadas**. 
âœ… **Suporta condiÃ§Ãµes booleanas** (AND, OR). 
âœ… **NÃ£o pode ser usada sem GROUP BY**, **exceto** quando uma funÃ§Ã£o agregada estÃ¡ presente. 
âœ… Deve ser **colocada apÃ³s GROUP BY** e **antes de ORDER BY** (se utilizado). 
âœ… **Gera relatÃ³rios resumidos** de **grandes conjuntos de dados**.

## **Sintaxe**

```
SELECT nome_da_coluna, FUNÃ‡ÃƒO_AGREGADA(nome_da_coluna)
FROM nome_da_tabela
GROUP BY nome_da_coluna
HAVING condiÃ§Ã£o;
```

ğŸ“Œ A **funÃ§Ã£o_agregada** pode ser **SUM(), AVG(), COUNT(), MAX(), MIN()**, etc.

### **Exemplos da clÃ¡usula HAVING no SQL**

Criamos um **banco de dados chamado "Company"**, e depois **criamos uma tabela chamada "Employee"**.

ApÃ³s **criar a tabela**, executamos os exemplos de consultas.

### **Criando a tabela Employee**

```
CREATE TABLE Employee (
  EmployeeId INT,
  Name VARCHAR(50),
  Gender VARCHAR(10),
  Salary INT,
  Department VARCHAR(20),
  Experience INT
);

-- Inserindo vÃ¡rios registros
INSERT INTO Employee (EmployeeId, Name, Gender, Salary, Department, Experience)
VALUES 
  (5, 'Priya Sharma', 'Feminino', 45000, 'TI', 2),
  (6, 'Rahul Patel', 'Masculino', 65000, 'Vendas', 5),
  (7, 'Nisha Gupta', 'Feminino', 55000, 'Marketing', 4),
  (8, 'Vikram Singh', 'Masculino', 75000, 'FinanÃ§as', 7),
  (9, 'Aarti Desai', 'Feminino', 50000, 'TI', 3);
```

ğŸ“Œ Agora, verificamos os registros inseridos:

```
SELECT * FROM Employee;
```

##### **SaÃ­da**

|EmployeeId|Nome|GÃªnero|SalÃ¡rio|Departamento|ExperiÃªncia|
|---|---|---|---|---|---|
|5|Priya Sharma|Feminino|45000|TI|2|
|6|Rahul Patel|Masculino|65000|Vendas|5|
|7|Nisha Gupta|Feminino|55000|Marketing|4|
|8|Vikram Singh|Masculino|75000|FinanÃ§as|7|
|9|Aarti Desai|Feminino|50000|TI|3|

## **Exemplo 1: Usando HAVING para Filtrar Resultados Agregados**

ğŸ¯ **Objetivo:**
- Encontrar **o total de salÃ¡rios** por departamento.

```
SELECT Department, SUM(Salary) AS Total_Salary
FROM Employee
GROUP BY Department;
```

##### **SaÃ­da**

|Departamento|Total_Salary|
|---|---|
|TI|95000|
|FinanÃ§as|75000|
|Marketing|55000|
|Vendas|65000|

Agora, queremos **mostrar apenas os departamentos onde o salÃ¡rio total seja 50.000 ou mais**.

ğŸ“Œ **Usamos a clÃ¡usula HAVING para aplicar essa condiÃ§Ã£o**:

```
SELECT Department, SUM(Salary) AS Total_Salary
FROM Employee
GROUP BY Department
HAVING SUM(Salary) >= 50000;
```

##### **SaÃ­da**

|Departamento|Total_Salary|
|---|---|
|TI|95000|
|FinanÃ§as|75000|
|Marketing|55000|
|Vendas|65000|

ğŸ“Œ **A clÃ¡usula HAVING filtrou os dados agrupados!**

## **Exemplo 2: Usando HAVING com MÃºltiplas CondiÃ§Ãµes**

ğŸ¯ **Objetivo:**

- Encontrar departamentos onde: 
- âœ… **SalÃ¡rio total seja maior ou igual a $50.000** 
- âœ… **SalÃ¡rio mÃ©dio seja maior que $55.000**

```
SELECT Department, SUM(Salary) AS Total_Salary, AVG(Salary) AS Average_Salary
FROM Employee
GROUP BY Department
HAVING SUM(Salary) >= 50000 AND AVG(Salary) > 55000;
```

##### **SaÃ­da**

|Departamento|Total_Salary|Average_Salary|
|---|---|---|
|FinanÃ§as|75000|75000|
|Vendas|65000|65000|

ğŸ“Œ **A clÃ¡usula HAVING permitiu aplicar mÃºltiplas condiÃ§Ãµes no agrupamento!**

## **Exemplo 3: Usando HAVING com COUNT()**

ğŸ¯ **Objetivo:**

- Encontrar **departamentos com mais de dois funcionÃ¡rios**.

```
SELECT Department, COUNT(EmployeeId) AS Employee_Count
FROM Employee
GROUP BY Department
HAVING COUNT(EmployeeId) >= 2;
```

##### **SaÃ­da**

|Departamento|Employee_Count|
|---|---|
|TI|2|

ğŸ“Œ **Contamos funcionÃ¡rios por departamento e filtramos aqueles com mais de dois funcionÃ¡rios!**

## **Exemplo 4: Usando HAVING com AVG()**

ğŸ¯ **Objetivo:**
- Encontrar departamentos **onde o salÃ¡rio mÃ©dio seja maior que $50.000**.

```
SELECT Department, AVG(Salary) AS Average_Salary
FROM Employee
GROUP BY Department
HAVING AVG(Salary) > 50000;
```

##### **SaÃ­da**

|Departamento|Average_Salary|
|---|---|
|FinanÃ§as|75000|
|Marketing|55000|
|Vendas|65000|

ğŸ“Œ **O HAVING filtrou os grupos com salÃ¡rio mÃ©dio acima de 50.000!**

## **DiferenÃ§a entre HAVING e WHERE**

|**HAVING**|**WHERE**|
|---|---|
|**Filtra grupos** de registros agrupados|**Filtra registros individuais antes da agregaÃ§Ã£o**|
|**SÃ³ pode ser usado com funÃ§Ãµes agregadas**|**NÃ£o pode ser usado com funÃ§Ãµes agregadas**|
|**Executado apÃ³s GROUP BY**|**Executado antes do GROUP BY**|

## **ConclusÃ£o**


ğŸ“Œ **A clÃ¡usula HAVING Ã© uma ferramenta essencial no SQL para filtrar dados agregados**.

âœ… Permite **filtrar grupos** de dados com **SUM(), AVG(), COUNT()**, etc. âœ… Diferente da clÃ¡usula **WHERE**, ela **opera em grupos apÃ³s a agregaÃ§Ã£o**. âœ… Ajuda a **gerar relatÃ³rios detalhados** e **realizar anÃ¡lises mais avanÃ§adas**.

ğŸš€ **Dominar essa ferramenta tornarÃ¡ suas consultas SQL muito mais eficientes!**


